% Plot permittivity of polymer matrix and interphase (output from prony series) as a% function of frequency% Oct 17 2014. Compare with experimental valuesfunction[] = myfun_plot(data_file, EleNum)%clear all%clc, close all% ------------------input section------------------------inc = 0.1;logfreq = -4:inc:6;TS1                   = 0.75;           % beta relaxation, s_beta, Tau shift. For tau <= 1, Shift multiplier along x direction. 1 is no shiftDS1                   = 10;             % beta relaxation, M_beta, DeltaEpsilonShiftFor tau <= 1, Shift multiplier along y direction. 1 is no shiftTS2                   = 0.02;           % Alpha relaxation, s_alpha, For tau > 1, Shift multiplier along x direction. 1 is no shiftDS2                   = 10;             % Alpha relaxation, M_alpha, For tau > 1, Shift multiplier along y direction. 1 is no shiftCES                   = -0.28+0.6;      % ConstEpsilonShift% -------------------------------------------------------% Read experimental values%ExptFile = 'EE.csv';      % one thing to read!!!!!!!!!!!!!%raw_datafile = strcat(experiment_file, '.X_T');raw_data= load('EE.X_T');dlmwrite('experiment.csv', raw_data, 'delimiter', ',', 'precision', 30);ExptFile = 'experiment.csv';PPcsv = csvread(ExptFile);ExptFreq = log10(PPcsv(:,1));ExptEp  = PPcsv(:,2);ExptEpp = PPcsv(:,3);% good fit datagoodE = csvread('goodfite.csv');goodEfreq = goodE(:, 1);goodEp = goodE(:, 2);goodEE = csvread('goodfitee.csv');goodEEfreq = goodEE(:, 1);goodEEp = goodEE(:, 2);% Read in prony series value of polymer%datafile='EE_90_compliance.XPR';      % one thing to read!!!!!!!!!!!!%datafile = strcat(data_file, '.XPR')mm=load(data_file);NumOfDebyeTerms = str2num(EleNum) + 1; % (Actual No. of Terms + 1) for eps_inf%NumOfDebyeTerms = EleNum + 1;TemPR=zeros(NumOfDebyeTerms,2);eps_inf_add = -0.06;TemPR(end,2)= 2.25+eps_inf_add; % epsilon_infTemPR(1:(NumOfDebyeTerms-1),2)=mm(1:end,4);% deltaEpsTemPR(1:(NumOfDebyeTerms-1),1)=mm(1:end,1); % tau[NumOfTerms,Temp] = size(TemPR); % Prony series coefficientsepsilon_inf = TemPR(NumOfTerms,2);ep = zeros(length(logfreq),1);epp=zeros(length(logfreq),1);intep = zeros(length(logfreq),1);intepp=zeros(length(logfreq),1);for j = 1:length(logfreq)    epsilonp =0; epsilonpp =0;    intepsilonp = 0; intepsilonpp = 0;    freq =10^logfreq(j);    for i = 1 : NumOfTerms - 1        deltaEpsilon =TemPR(i,2);        tau =TemPR(i,1);        epsilonp = epsilonp  + deltaEpsilon*(freq*tau)^2/(1+(freq*tau)^2);        epsilonpp = epsilonpp + deltaEpsilon*freq*tau/(1+(freq*tau)^2);        if tau>1            intepsilonp = intepsilonp + DS2*deltaEpsilon*TS2*freq*tau/(1+(TS2*freq*tau)^2);            intepsilonpp = intepsilonpp + DS2*deltaEpsilon*TS2*freq*tau/(1+(TS2*freq*tau)^2);        else            intepsilonp = intepsilonp + DS1*deltaEpsilon*TS1*freq*tau/(1+(TS1*freq*tau)^2);            intepsilonpp = intepsilonpp + DS1*deltaEpsilon*TS1*freq*tau/(1+(TS1*freq*tau)^2);        end    end    %epsilonp = epsilonp + epsilon_inf;    epsilonp = epsilonp;    % one thing to change!!!!!!!!!!!!!!!    intepsilonp = intepsilonp + epsilon_inf+CES;    ep(j) = epsilonp; epp(j) = epsilonpp;    intep(j) = intepsilonp; intepp(j)=intepsilonpp;endlogfreq=logfreq';% Plot prony series prediction and expt valuesfigure(), plot(logfreq,log10(ep), 'g'), hold onplot(ExptFreq, log10(ExptEp), '*r'), hold onplot(goodEfreq, goodEp)xlabel 'log(Frequency [Hz])'xlim([ExptFreq(1)+0.5 ExptFreq(length(ExptFreq))-0.5])   % one thing to read!!!!!!!!!!!!ylabel '\epsilon^'''legend('User Fitted Debye series','Experiment', 'Fitted Debye series')h = gcf;set(h, 'Visible', 'off');saveas(h,['./exampleE'],'jpeg');figure(), plot(logfreq,log10(epp), 'g'),hold onplot(ExptFreq, log10(ExptEpp), '*r'), hold onplot(goodEEfreq, goodEEp)xlabel 'log(Frequency [Hz])'xlim([ExptFreq(1)+0.5 ExptFreq(length(ExptFreq))-0.5])    % one thing to read!!!!!!!!!!!ylabel '\epsilon^"'legend('User Fitted Debye series', 'Experiment', 'Fitted Debye series')h = gcf;set(h, 'Visible', 'off');saveas(h,['./exampleEE'],'jpeg');end